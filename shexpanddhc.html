<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content="fortran,  spherical harmonics software package, spherical harmonic transform, legendre functions, multitaper spectral analysis, fortran, Python, gravity, magnetic field">
<title>SHExpandDHC (Fortran) | SHTOOLS - Tools for working with spherical harmonics</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://shtools.oca.eu/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> SHTOOLS</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="https://github.com/SHTOOLS/SHTOOLS/" target="_blank">GitHub</a></li>
                
                
                
                <li><a href="https://github.com/SHTOOLS/SHTOOLS/wiki" target="_blank">Wiki</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:mark.wieczorek@oca.eu?subject=SHTOOLS feedback&body=I have some feedback about SHExpandDHC (Fortran) page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="SHExpandDHC (Fortran)">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle">SHTOOLS 4.3</li>
  
  
  
      
  
  <li>
      <a href="#">Getting started</a>
      <ul>
          
          
          
          <li><a href="index.html">Overview</a></li>
          
          
          
          
          
          
          <li><a href="installing.html">Installing</a></li>
          
          
          
          
          
          
          <li><a href="using-with-f95.html">Using with Fortran 95</a></li>
          
          
          
          
          
          
          <li><a href="using-with-python.html">Using with Python</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Spherical harmonics</a>
      <ul>
          
          
          
          <li><a href="real-spherical-harmonics.html">Real spherical harmonics</a></li>
          
          
          
          
          
          
          <li><a href="complex-spherical-harmonics.html">Complex spherical harmonics</a></li>
          
          
          
          
          
          
          <li><a href="implementation-details.html">Implementation details</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Fortran 95 Routines</a>
      <ul>
          
          
          
          <li><a href="f95-modules.html">Modules</a></li>
          
          
          
          
          
          
          <li><a href="legendre-functions.html">Legendre functions</a></li>
          
          
          
          
          
          
          <li><a href="spherical-harmonic-transforms.html">Spherical harmonic transformations</a></li>
          
          
          
          
          
          
          <li><a href="io.html">I/O, storage, conversions</a></li>
          
          
          
          
          
          
          <li><a href="global-spectral-analysis.html">Global spectral analysis</a></li>
          
          
          
          
          
          
          <li><a href="localized-spectral-analysis.html">Localized spectral analysis</a></li>
          
          
          
          
          
          
          <li><a href="spherical-harmonic-rotations.html">Spherical harmonic rotations</a></li>
          
          
          
          
          
          
          <li><a href="gravity-magnetics.html">Gravity and magnetics</a></li>
          
          
          
          
          
          
          <li><a href="miscellaneous-routines.html">Miscellaneous</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Python components</a>
      <ul>
          
          
          
          <li><a href="python-classes.html">Python classes</a></li>
          
          
          
          
          
          
          <li><a href="python-legendre-functions.html">Legendre functions</a></li>
          
          
          
          
          
          
          <li><a href="python-spherical-harmonic-transforms.html">Spherical harmonic transformations</a></li>
          
          
          
          
          
          
          <li><a href="python-io.html">I/O, storage, conversions</a></li>
          
          
          
          
          
          
          <li><a href="python-spectral-analysis.html">Global and localized spectral analysis</a></li>
          
          
          
          
          
          
          <li><a href="python-spherical-harmonic-rotations.html">Spherical harmonic rotations</a></li>
          
          
          
          
          
          
          <li><a href="python-gravity-magnetics.html">Gravity and magnetics</a></li>
          
          
          
          
          
          
          <li><a href="python-utilities.html">Utilities</a></li>
          
          
          
          
          
          
          <li><a href="python-constants.html">Constants</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Examples programs</a>
      <ul>
          
          
          
          <li><a href="python-examples.html">Python examples</a></li>
          
          
          
          
          
          
          <li><a href="fortran-examples.html">Fortran 95 examples</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Support</a>
      <ul>
          
          
          
          <li><a href="faq.html">FAQ</a></li>
          
          
          
          
          
          
          <li><a href="fortran-95-problems.html">Fortran 95 problems</a></li>
          
          
          
          
          
          
          <li><a href="how-to-contribute.html">How to contribute</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Release Notes</a>
      <ul>
          
          
          
          <li><a href="release-notes-v4.html">Version 4</a></li>
          
          
          
          
          
          
          <li><a href="release-notes-v3.html">Version 3</a></li>
          
          
          
          
          
          
          <li><a href="license.html">License</a></li>
          
          
          
          
          
          
          <li><a href="contributors.html">Contributors</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  displayAlign: "left",
  displayIndent: "2em"
});
</script>

<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<div class="post-header">
   <h1 class="post-title-main">SHExpandDHC (Fortran)</h1>
</div>



<div class="post-content">

   

    

  <p>Expand an equally sampled or equally spaced complex grid into complex spherical harmonics using Driscoll and Healy’s (1994) sampling theorem.</p>

<h2 id="usage">Usage</h2>

<p>call SHExpandDHC (<code class="highlighter-rouge">griddh</code>, <code class="highlighter-rouge">n</code>, <code class="highlighter-rouge">cilm</code>, <code class="highlighter-rouge">lmax</code>, <code class="highlighter-rouge">norm</code>, <code class="highlighter-rouge">sampling</code>, <code class="highlighter-rouge">csphase</code>, <code class="highlighter-rouge">lmax_calc</code>, <code class="highlighter-rouge">exitstatus</code>)</p>

<h2 id="parameters">Parameters</h2>

<dl>
  <dt><code class="highlighter-rouge">griddh</code> : input, complex*16, dimension (<code class="highlighter-rouge">n</code>, <code class="highlighter-rouge">n</code>) or (<code class="highlighter-rouge">n</code>, 2*<code class="highlighter-rouge">n</code>)</dt>
  <dd>A 2D equally sampled (default) or equally spaced complex grid that conforms to the sampling theorem of Driscoll and Healy (1994). The first latitudinal band corresponds to 90 N, the latitudinal band for 90 S is not included, and the latitudinal sampling interval is 180/<code class="highlighter-rouge">n</code> degrees. The first longitudinal band is 0 E, the longitude band for 360 E is not included, and the longitudinal sampling interval is 360/<code class="highlighter-rouge">n</code> for an equally and 180/<code class="highlighter-rouge">n</code> for an equally spaced grid, respectively.</dd>
  <dt><code class="highlighter-rouge">n</code> : input, integer</dt>
  <dd>The number of samples in latitude of <code class="highlighter-rouge">griddh</code>. If <code class="highlighter-rouge">sampling</code> is 1 (default) then the number of samples in longitude is <code class="highlighter-rouge">n</code>. If <code class="highlighter-rouge">sampling</code> is 2 then the number of longitudinal samples is <code class="highlighter-rouge">2n</code>. <code class="highlighter-rouge">n</code> must be even.</dd>
  <dt><code class="highlighter-rouge">cilm</code> : output, complex*16, dimension (2, <code class="highlighter-rouge">n</code>/2, <code class="highlighter-rouge">n</code>/2) or (2, <code class="highlighter-rouge">lmax_calc</code>+1, <code class="highlighter-rouge">lmax_calc</code>+1)</dt>
  <dd>The complex spherical harmonic coefficients of the function. These will be exact if the function is bandlimited to degree <code class="highlighter-rouge">lmax=n/2-1</code>. The first index specifies the coefficient corresponding to the positive and negative order of <code class="highlighter-rouge">m</code>, respectively, with <code class="highlighter-rouge">Clm=cilm(1,l+1,m+1)</code> and <code class="highlighter-rouge">Cl,-m=cilm(2,l+1,m+1)</code>.</dd>
  <dt><code class="highlighter-rouge">lmax</code> : output, integer</dt>
  <dd>The maximum spherical harmonic bandwidth of the input grid, which is <code class="highlighter-rouge">n</code>/2 - 1. If the optional parameter <code class="highlighter-rouge">lmax_calc</code> is not specified, this corresponds to the maximum spherical harmonic degree of the output coefficients <code class="highlighter-rouge">cilm</code>.</dd>
  <dt><code class="highlighter-rouge">norm</code> : input, optional, integer, default = 1</dt>
  <dd>1 (default) = 4-pi (geodesy) normalized harmonics; 2 = Schmidt semi-normalized harmonics; 3 = unnormalized harmonics; 4 = orthonormal harmonics.</dd>
  <dt><code class="highlighter-rouge">sampling</code> : input, optional, integer, default = 1</dt>
  <dd>If 1 (default) the input grid is equally sampled (<code class="highlighter-rouge">n</code> by <code class="highlighter-rouge">n</code>). If 2, the grid is equally spaced (<code class="highlighter-rouge">n</code> by <code class="highlighter-rouge">2n</code>).</dd>
  <dt><code class="highlighter-rouge">csphase</code> : input, optional, integer, default = 1</dt>
  <dd>1 (default) = do not apply the Condon-Shortley phase factor to the associated Legendre functions; -1 = append the Condon-Shortley phase factor of (-1)^m to the associated Legendre functions.</dd>
  <dt><code class="highlighter-rouge">lmax_calc</code> : input, optional, integer, default = <code class="highlighter-rouge">lmax</code></dt>
  <dd>The maximum spherical harmonic degree calculated in the spherical harmonic expansion.</dd>
  <dt><code class="highlighter-rouge">exitstatus</code> : output, optional, integer</dt>
  <dd>If present, instead of executing a STOP when an error is encountered, the variable exitstatus will be returned describing the error. 0 = No errors; 1 = Improper dimensions of input array; 2 = Improper bounds for input variable; 3 = Error allocating memory; 4 = File IO error.</dd>
</dl>

<h2 id="description">Description</h2>

<p><code class="highlighter-rouge">SHExpandDHC</code> will expand an equally sampled (<code class="highlighter-rouge">n</code> by <code class="highlighter-rouge">n</code>) or equally spaced complex grid (<code class="highlighter-rouge">n</code> by <code class="highlighter-rouge">2n</code>) into complex spherical harmonics using the sampling theorem of Driscoll and Healy (1994). The number of latitudinal samples <code class="highlighter-rouge">n</code> must be even, and the transform is exact if the function is bandlimited to spherical harmonic degree <code class="highlighter-rouge">n</code>/2 - 1. The inverse transform is given by the routine <code class="highlighter-rouge">MakeGridDHC</code>. If the optional parameter <code class="highlighter-rouge">lmax_calc</code> is specified, the spherical harmonic coefficients will only be calculated to this degree instead of <code class="highlighter-rouge">n</code>/2 - 1. The algorithm is based on performing FFTs in longitude and then integrating over latitude using an exact quadrature rule.</p>

<p>The default is to use an input grid that is equally sampled (<code class="highlighter-rouge">n</code> by <code class="highlighter-rouge">n</code>), but this can be changed to use an equally spaced grid (<code class="highlighter-rouge">n</code> by <code class="highlighter-rouge">2n</code>) by the optional argument <code class="highlighter-rouge">sampling</code>.  When using an equally spaced grid, the Fourier components corresponding to degrees greater than <code class="highlighter-rouge">n</code>/2 - 1 are simply discarded; this is done to prevent aliasing that would occur if an equally sampled grid was constructed from an equally spaced grid by discarding every other column of the input grid.</p>

<p>The employed spherical harmonic normalization and Condon-Shortley phase convention can be set by the optional arguments <code class="highlighter-rouge">norm</code> and <code class="highlighter-rouge">csphase</code>; if not set, the default is to use geodesy 4-pi normalized harmonics that exclude the Condon-Shortley phase of (-1)^m. The normalized legendre functions are calculated in this routine using the scaling algorithm of Holmes and Featherstone (2002), which are accurate to about degree 2800. The unnormalized functions are accurate only to about degree 15.</p>

<h2 id="references">References</h2>

<p>Driscoll, J.R. and D.M. Healy, Computing Fourier transforms and convolutions on the 2-sphere, Adv. Appl. Math., 15, 202-250, 1994.</p>

<p>Holmes, S. A., and W. E. Featherstone, A unified approach to the Clenshaw summation and the recursive computation of very high degree and order normalised associated Legendre functions, J. Geodesy, 76, 279-299, 2002.</p>

<h2 id="see-also">See also</h2>

<p><a href="makegriddhc.html">makegriddhc</a>, <a href="makegriddh.html">makegriddh</a>, <a href="shexpanddh.html">shexpanddh</a>, <a href="makegridglq.html">makegridglq</a>, <a href="shexpandglq.html">shexpandglq</a>, <a href="makegridglqc.html">makegridglqc</a>, <a href="shexpandglqc.html">shexpandglqc</a>, <a href="shexpandlsq.html">shexpandlsq</a></p>


    <div class="tags">
        
        <b>Tags: </b>
        
        
        
        <a href="tag_fortran.html" class="btn btn-default navbar-btn cursorNorm" role="button">fortran</a>
        
        
        
    </div>

    

    <a target="_blank" href="https://github.com/SHTOOLS/SHTOOLS/tree/develop/src/fdoc/shexpanddhc.md" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit me</a>

    

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2018 SHTOOLS. All rights reserved. <br />
<a href="https://www.oca.eu/?lang=en" target="_blank" rel="noopener">Observatoire de la Côte d'Azur</a><br />
<a href="https://lagrange.oca.eu/fr/accueil-lagrange" target="_blank" rel="noopener">Laboratoire Lagrange</a><br />
<p><img src="images/company_logo.png" alt="SHTOOLS"/></p>
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>
