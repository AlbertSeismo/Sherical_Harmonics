<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content="python,  spherical harmonics software package, spherical harmonic transform, legendre functions, multitaper spectral analysis, fortran, Python, gravity, magnetic field">
<title>Wigner3j (Python) | SHTOOLS - Tools for working with spherical harmonics</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://shtools.oca.eu/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> SHTOOLS</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="https://github.com/SHTOOLS/SHTOOLS/" target="_blank">GitHub</a></li>
                
                
                
                <li><a href="https://github.com/SHTOOLS/SHTOOLS/wiki" target="_blank">Wiki</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:mark.wieczorek@oca.eu?subject=SHTOOLS feedback&body=I have some feedback about Wigner3j (Python) page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Wigner3j (Python)">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle">SHTOOLS 4.3</li>
  
  
  
      
  
  <li>
      <a href="#">Getting started</a>
      <ul>
          
          
          
          <li><a href="index.html">Overview</a></li>
          
          
          
          
          
          
          <li><a href="installing.html">Installing</a></li>
          
          
          
          
          
          
          <li><a href="using-with-f95.html">Using with Fortran 95</a></li>
          
          
          
          
          
          
          <li><a href="using-with-python.html">Using with Python</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Spherical harmonics</a>
      <ul>
          
          
          
          <li><a href="real-spherical-harmonics.html">Real spherical harmonics</a></li>
          
          
          
          
          
          
          <li><a href="complex-spherical-harmonics.html">Complex spherical harmonics</a></li>
          
          
          
          
          
          
          <li><a href="implementation-details.html">Implementation details</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Fortran 95 Routines</a>
      <ul>
          
          
          
          <li><a href="f95-modules.html">Modules</a></li>
          
          
          
          
          
          
          <li><a href="legendre-functions.html">Legendre functions</a></li>
          
          
          
          
          
          
          <li><a href="spherical-harmonic-transforms.html">Spherical harmonic transformations</a></li>
          
          
          
          
          
          
          <li><a href="io.html">I/O, storage, conversions</a></li>
          
          
          
          
          
          
          <li><a href="global-spectral-analysis.html">Global spectral analysis</a></li>
          
          
          
          
          
          
          <li><a href="localized-spectral-analysis.html">Localized spectral analysis</a></li>
          
          
          
          
          
          
          <li><a href="spherical-harmonic-rotations.html">Spherical harmonic rotations</a></li>
          
          
          
          
          
          
          <li><a href="gravity-magnetics.html">Gravity and magnetics</a></li>
          
          
          
          
          
          
          <li><a href="miscellaneous-routines.html">Miscellaneous</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Python components</a>
      <ul>
          
          
          
          <li><a href="python-classes.html">Python classes</a></li>
          
          
          
          
          
          
          <li><a href="python-legendre-functions.html">Legendre functions</a></li>
          
          
          
          
          
          
          <li><a href="python-spherical-harmonic-transforms.html">Spherical harmonic transformations</a></li>
          
          
          
          
          
          
          <li><a href="python-io.html">I/O, storage, conversions</a></li>
          
          
          
          
          
          
          <li><a href="python-spectral-analysis.html">Global and localized spectral analysis</a></li>
          
          
          
          
          
          
          <li><a href="python-spherical-harmonic-rotations.html">Spherical harmonic rotations</a></li>
          
          
          
          
          
          
          <li><a href="python-gravity-magnetics.html">Gravity and magnetics</a></li>
          
          
          
          
          
          
          <li><a href="python-utilities.html">Utilities</a></li>
          
          
          
          
          
          
          <li><a href="python-constants.html">Constants</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Examples programs</a>
      <ul>
          
          
          
          <li><a href="python-examples.html">Python examples</a></li>
          
          
          
          
          
          
          <li><a href="fortran-examples.html">Fortran 95 examples</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Support</a>
      <ul>
          
          
          
          <li><a href="faq.html">FAQ</a></li>
          
          
          
          
          
          
          <li><a href="fortran-95-problems.html">Fortran 95 problems</a></li>
          
          
          
          
          
          
          <li><a href="how-to-contribute.html">How to contribute</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Release Notes</a>
      <ul>
          
          
          
          <li><a href="release-notes-v4.html">Version 4</a></li>
          
          
          
          
          
          
          <li><a href="release-notes-v3.html">Version 3</a></li>
          
          
          
          
          
          
          <li><a href="license.html">License</a></li>
          
          
          
          
          
          
          <li><a href="contributors.html">Contributors</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  displayAlign: "left",
  displayIndent: "2em"
});
</script>

<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<div class="post-header">
   <h1 class="post-title-main">Wigner3j (Python)</h1>
</div>



<div class="post-content">

   

    

  <p>Compute the Wigner-3j symbols for all allowable values of J.</p>

<h2 id="usage">Usage</h2>

<p><code class="highlighter-rouge">w3j</code>, <code class="highlighter-rouge">jmin</code>, <code class="highlighter-rouge">jmax</code> = Wigner3j (<code class="highlighter-rouge">j2</code>, <code class="highlighter-rouge">j3</code>, <code class="highlighter-rouge">m1</code>, <code class="highlighter-rouge">m2</code>, <code class="highlighter-rouge">m3</code>)</p>

<h2 id="returns">Returns</h2>

<dl>
  <dt><code class="highlighter-rouge">w3j</code> : float, dimension (<code class="highlighter-rouge">j2</code>+<code class="highlighter-rouge">j3</code>+1)</dt>
  <dd>An array of the Wigner-3j symbols evaluated for all allowable values of <code class="highlighter-rouge">j</code>. The minimum and maximum values of <code class="highlighter-rouge">j</code> are given by <code class="highlighter-rouge">jmin</code> and <code class="highlighter-rouge">jmax</code>.</dd>
  <dt><code class="highlighter-rouge">jmin</code> : integer</dt>
  <dd>The minimum value of <code class="highlighter-rouge">j</code> in the array <code class="highlighter-rouge">w3j</code>. This corresponds to the first element of <code class="highlighter-rouge">w3j</code>.</dd>
  <dt><code class="highlighter-rouge">jmax</code> : integer</dt>
  <dd>The maximum value of <code class="highlighter-rouge">j</code> in the array <code class="highlighter-rouge">w3j</code>. This corresponds to the last non-zero element of <code class="highlighter-rouge">w3j</code>.</dd>
</dl>

<h2 id="parameters">Parameters</h2>

<dl>
  <dt><code class="highlighter-rouge">j2</code> : integer</dt>
  <dd>A positive integer.</dd>
  <dt><code class="highlighter-rouge">j3</code> : integer</dt>
  <dd>A positive integer.</dd>
  <dt><code class="highlighter-rouge">m1</code> : integer</dt>
  <dd>An integer.</dd>
  <dt><code class="highlighter-rouge">m2</code> : integer</dt>
  <dd>An integer.</dd>
  <dt><code class="highlighter-rouge">m3</code> : integer</dt>
  <dd>An integer.</dd>
</dl>

<h2 id="description">Description</h2>

<p><code class="highlighter-rouge">Wigner3j</code> will calculate the Wigner 3J symbols</p>

<p><code class="highlighter-rouge">/ j  j2 j3 \</code><br />
<code class="highlighter-rouge">\ m1 m2 m3 /</code></p>

<p>for all allowable values of <code class="highlighter-rouge">j</code>. The returned values in the array <code class="highlighter-rouge">w3j</code> are calculated only for the limits</p>

<p><code class="highlighter-rouge">jmin = max(|j2-j3|, |m1|)</code>  and</p>

<p><code class="highlighter-rouge">jmax = j2 + j3</code>.</p>

<p>To be non-zero, <code class="highlighter-rouge">m1+m2+m3</code> must equal 0. It is assumed that all <code class="highlighter-rouge">j</code>s and <code class="highlighter-rouge">m</code>s are integers. Returned values have a relative error less than ~1.d-8 when <code class="highlighter-rouge">j2</code> and <code class="highlighter-rouge">j3</code> are less than about 100 (see below). In practice, this routine is probably usable up to about 165.</p>

<p>The employed algorithm is based upon the stable non-linear recurrence relations of Luscombe and Luban (1998) for the “non classical” regions near <code class="highlighter-rouge">jmin and jmax</code>. The direction of the iteration starts from low values of <code class="highlighter-rouge">j</code> to high values, but when <code class="highlighter-rouge">abs(w3j(j+2)/w3j(j))</code> is less than one, the iteration will restart from high to low values. For the classical region, the standard three term recursion relationship is used (e.g., Schulten and Gordon 1975). As this three term recursion can lead to overflows, the values are rescaled by a factor “scalef” whenever the absolute value of the 3j coefficient becomes greater than unity.  More efficient algorithms probably exist for specific cases (for instance, when all Ms are zero).</p>

<p>The results of this routine have been verified against the same routine run in quadruple precision. For 1.e7 acceptable random values of <code class="highlighter-rouge">j2</code>, <code class="highlighter-rouge">j3</code>, <code class="highlighter-rouge">m2</code>, and <code class="highlighter-rouge">m3</code> between -200 and 200, the relative error was calculated only for those 3j coefficients that had an absolute value greater than 1.d-17 (values smaller than this are for all practical purposed zero, and can be heavily affected by machine roundoff errors or underflow). 853 combinations of parameters were found to have relative errors greater than 1.d-8. Here I list the minimum value of <code class="highlighter-rouge">max(j2,j3)</code> for different ranges of error, as well as the number of times this error occurred:</p>

<p><code class="highlighter-rouge">max(j2,j3) = 103: 1.d-7 &lt; error &lt;=1.d-8 ; Number of occurrences = 483</code><br />
<code class="highlighter-rouge">max(j2,j3) = 116: 1.d-6 &lt; error &lt;= 1.d-7 ; Number of occurrences = 240</code><br />
<code class="highlighter-rouge">max(j2,j3) = 165: 1.d-5 &lt; error &lt;= 1.d-6 ; Number of occurrences = 93</code><br />
<code class="highlighter-rouge">max(j2,j3) = 167: 1.d-4 &lt; error &lt;= 1.d-5 ; Number of occurrences = 36</code></p>

<p>Many times, the large relative errors occur when the 3j coefficient changes sign and is very close to zero (i.e., adjacent values are about 1.e7 times greater in magnitude). Thus, if one does not need to know highly accurate values of the 3j coefficients when they are almost zero (i.e., ~1.e-10) then this routine is probably usable up to about 160.</p>

<p>These results have also been verified for parameter values less than 100 using a code based on the algorith of de Blanc (1987), which was originally coded by Olav van Genabeek, and modified by M. Fang. (This code was run in quadruple precision and only calculates one coefficient for each call.) Maximum relative errors between the two routines were less than 1.d-8 for a large number of values (again, only 3j coefficients greater than 1.d-17 were considered here).</p>

<h2 id="references">References</h2>

<p>Luscombe, J. J., and M. Luban, Simplified recursive algorithm for Wigner 3j and 6j symbols, Phys. Rev. E, 57, 7274-7277, 1998.</p>

<p>Schulten, K., and R. G. Gordon, Exact recursive evaluation of 3j-coefficients
and 6j-coefficients for quantum-mechanical coupling of angular momenta, J. Math. Phys., 16, 1961-1970, 1975.</p>


    <div class="tags">
        
        <b>Tags: </b>
        
        
        
        <a href="tag_python.html" class="btn btn-default navbar-btn cursorNorm" role="button">python</a>
        
        
        
    </div>

    

    <a target="_blank" href="https://github.com/SHTOOLS/SHTOOLS/tree/develop/src/pydoc/pywigner3j.md" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit me</a>

    

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2018 SHTOOLS. All rights reserved. <br />
<a href="https://www.oca.eu/?lang=en" target="_blank" rel="noopener">Observatoire de la Côte d'Azur</a><br />
<a href="https://lagrange.oca.eu/fr/accueil-lagrange" target="_blank" rel="noopener">Laboratoire Lagrange</a><br />
<p><img src="images/company_logo.png" alt="SHTOOLS"/></p>
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>
